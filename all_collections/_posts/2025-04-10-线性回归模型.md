---
layout: post
title: çº¿æ€§å›å½’æ¨¡å‹
date: 2025-04-10 00:00:00
categories: ["æœºå™¨å­¦ä¹ "]
---
![é…å›¾](/assets/images/posts/3-1.jpg)

//è¾…åŠ©æˆ¿åœ°äº§ä¼°ä»· ï¼ˆæ‹Ÿåˆç›´çº¿

**æ ¸å¿ƒæ¦‚å¿µï¼š**
- ç”¨äºè®­ç»ƒæ¨¡å‹çš„æ•°æ®é›†ç§°ä¸ºè®­ç»ƒé›†
- è¾“å…¥å˜é‡ï¼ˆxï¼‰ ï¼šä¹Ÿç§°ä¸ºç‰¹å¾æˆ–è¾“å…¥ç‰¹å¾//input
- è¾“å‡ºå˜é‡ï¼ˆyï¼‰ ï¼šè¾“å‡ºçš„é‡//output target

ï¼ˆxï¼Œyï¼‰å³ä¸€ä¸ªè®­ç»ƒç¤ºä¾‹, $x^{(i)}$ , $y^{(i)}$ è¡¨ç¤ºç¬¬iä¸ªè®­ç»ƒç¤ºä¾‹
**è®­ç»ƒæ¨¡å‹**ï¼šå°†è®­ç»ƒé›†æä¾›ç»™å­¦ä¹ ç®—æ³•ï¼Œ
ç®—æ³•ä¼šäº§ç”ŸåŠŸèƒ½function $x \to f \to \hat y$   
è¯¥è¿‡ç¨‹å³ï¼šfeature -> model -> prediction
 $f_{(w,b)}(x)=wx+b$  
### æˆæœ¬å‡½æ•°ï¼ˆä¹Ÿç§°ä¸ºä»£ä»·å‡½æ•°ï¼‰
æˆæœ¬å‡½æ•°çš„æ€æƒ³æ˜¯æœºå™¨å­¦ä¹ ä¸­æœ€æ™®éå’Œæœ€é‡è¦çš„æ€æƒ³ä¹‹ä¸€ï¼Œç”¨äºçº¿æ€§å›å½’å’Œè®­ç»ƒä¸–ç•Œä¸Šè®¸å¤šæœ€å…ˆè¿›çš„äººå·¥æ™ºèƒ½æ¨¡å‹ã€‚

ğŸ‘‰å¦‚ä½•æ„å»º**æˆæœ¬å‡½æ•°**ï¼š   
å¹³æ–¹è¯¯å·®æˆæœ¬å‡½æ•°   
    $$J_{(w,b)}= \frac{1}{2m} \sum\limits_{i=1}^m(\hat{y}^{(i)} -y^{(i)})$$   
    $$J_{(w,b)}= \frac{1}{2m} \sum\limits_{i=1}^m(f_{(w,b)}(x) -y^{(i)})$$ 
    
P.S.
- mæŒ‡çš„æ˜¯è®­ç»ƒç¤ºä¾‹ä¸ªæ•°ï¼›
- å°†æ¯ä¸ªé¢„æµ‹çš„yå€¼ä¸çœŸå®çš„yå€¼ç›¸å·®å¹³æ–¹æ±‚å’Œï¼›
- é¢å¤–é™¤çš„2æ˜¯ä¸ºäº†åç»­çš„è®¡ç®—æ›´åŠ ç®€æ´ï¼›

ç›®æ ‡æ˜¯æ±‚ï¼š $minimize_{w,b} J(w,b)$
  è®©æˆæœ¬å‡½æ•°å°½å¯èƒ½çš„å°ï¼Œæ¨¡å‹çš„å‡†ç¡®åº¦ä¹Ÿå°±è¶Šé«˜
![é…å›¾](/assets/images/posts/3-2.jpg)

ğŸ‘‰æˆæœ¬å‡½æ•°çš„å¯è§†åŒ–
![é…å›¾](/assets/images/posts/3-3.jpg)

è‹¥è§„å®šäº†bä¸€å®š åˆ™å›¾åƒä¸ºäºŒç»´åæ ‡å›¾åƒ ï¼ˆæ±¤ç¢—ä¾§åˆ‡å›¾çŠ¶ï¼‰
![é…å›¾](/assets/images/posts/3-4.jpg)

ç„¶è€Œç”¨3Då›¾å½¢è¡¨ç¤ºéå¸¸ä¸ä¾¿ï¼Œäºæ˜¯å¯ä»¥åŒ–æˆç­‰é«˜çº¿åœ°å½¢å›¾çš„æ¨¡å¼å»è¡¨ç¤º

### æ¢¯åº¦ä¸‹é™ç®—æ³•
![é…å›¾](/assets/images/posts/3-5.jpg)

åœ¨æˆæœ¬å‡½æ•°å›¾åƒä¸Šï¼Œä»æœ€é«˜ç‚¹å¼€å§‹ ä¸æ–­â€œç¯é¡¾å››å‘¨â€æ‰¾åˆ°æ–œç‡æœ€å¤§çš„æ–¹å‘å¹¶ç§»åŠ¨ä¸€æ®µæå°çš„è·ç¦»ï¼Œç»§ç»­æ‰¾ä¸‹é™æ–œç‡æœ€å¤§çš„æ–¹å‘ï¼Œå¦‚æ­¤é‡å¤ã€‚
 
 $$
 w=w-\alpha \frac{d}{dw} J_{(w,b)}
 $$    
 $$
 b=b-\alpha \frac{d}{db} J_{(w,b)}
 $$ 
   
 //â€˜=â€™ä½œä¸ºèµ‹å€¼è¿ç®—ç¬¦ï¼›$\alpha$ è¢«ç§°ä¸ºå­¦ä¹ ç‡ï¼›å­¦ä¹ ç‡é€šå¸¸æ˜¯0åˆ°1ä¹‹é—´çš„ä¸€ä¸ªå°æ­£æ•°
 
 $\alpha$ æ‰€åšçš„æ˜¯æ§åˆ¶ä¸‹å¡çš„è·ç¦»ï¼ˆæ¯ä¸€æ­¥çš„æ­¥é•¿ï¼‰
**åœ¨æ›²é¢å›¾å›¾å½¢ä¸­**ï¼Œæˆ‘ä»¬éœ€è¦é‡‡å–ä¸€äº›å°æ­¥å­ï¼Œç›´åˆ°åˆ°è¾¾å€¼çš„åº•éƒ¨ï¼›

**åœ¨æ¢¯åº¦ä¸‹é™ç®—æ³•ä¸­**ï¼Œæˆ‘ä»¬éœ€è¦ä¸æ–­é‡å¤ä¸Šè¿°ä¸¤ä¸ªå…¬å¼ï¼Œç›´åˆ°ç®—æ³•æ”¶æ•›ï¼ˆè¾¾åˆ°å±€éƒ¨æœ€å°å€¼ï¼‰

#### å­¦ä¹ ç‡
ğŸ‘‰å¦‚æœå­¦ä¹ ç‡çš„å€¼è¿‡äºå¤§ä¼šæ€ä¹ˆæ ·ï¼Ÿ

æœ‰å¯èƒ½å› ä¸ºæ­¥é•¿è¿‡é•¿å¯¼è‡´è¶Šè¿‡äº†æˆæœ¬å‡½æ•°çš„æœ€å°å€¼

### æ¢¯åº¦ä¸‹é™ç®—æ³•å®ç°

```python
# å¯¼å…¥åº“
import torch
import numpy as np
from pyecharts.charts import Line
from pyecharts.options import TitleOpts, ToolboxOpts

# æ•°æ®é›†å¯¼å…¥
x = np.array([0.18, 0.1, 0.16, 0.08, 0.09, 0.11, 0.17, 0.15, 0.14, 0.13])
y = np.array([0.18, 0.1, 0.16, 0.08, 0.09, 0.11, 0.17, 0.15, 0.14, 0.13])

# ç¡®å®šå­¦ä¹ ç‡
lr = 0.01

# åˆå§‹åŒ– wï¼Œä¸ºäº†å‡å°éš¾åº¦æš‚æ—¶ä¸è€ƒè™‘ b çš„èµ‹å€¼
w = 10

# epoches ä¸ºå¾ªç¯è¿›è¡Œçš„æ¬¡æ•°
epoches = 500

# å…ˆè®¾ç½®æ¢¯åº¦ä¸º 0
grad = 0

# è®¡ç®—æŸå¤±å‡½æ•°
def loss_new(x, y, w):
    return 0.5 * np.sum((w * x - y) ** 2)

# è®¡ç®—æ¢¯åº¦
def grad_new(x, y, w):
    return np.mean((x * w - y) * x)

# æ ¸å¿ƒéƒ¨åˆ† -- è¿­ä»£
list_w = []
list_loss = []
list_grad = []
list_i = []

for i in range(epoches):
    grad = grad_new(x, y, w)
    # æ›´æ–°å‚æ•°
    w = w - lr * grad
    loss = loss_new(x, y, w)
    print(f"ç¬¬{i + 1}æ¬¡è¿­ä»£ï¼Œæ¢¯åº¦ä¸º{grad}, æƒå€¼ä¸º{w}, æŸå¤±å€¼ä¸º{loss}")
    list_w.append(w)
    list_i.append(i)
    list_loss.append(loss)
    list_grad.append(grad)

# ç»˜åˆ¶æ¢¯åº¦ä¸è¿­ä»£æ¬¡æ•°çš„å…³ç³»å›¾
line1 = Line()
line1.add_xaxis(list_i)
line1.add_yaxis("æ¢¯åº¦", list_grad)
line1.set_global_opts(
    title_opts=TitleOpts(title="æ¢¯åº¦ä¸è¿­ä»£æ¬¡æ•°çš„å…³ç³»", pos_left="center", pos_bottom="1%"),
    toolbox_opts=ToolboxOpts(is_show=True),
)
line1.render()

# ç»˜åˆ¶æŸå¤±å€¼ä¸å‚æ•°çš„å…³ç³»å›¾
line2 = Line()
line2.add_xaxis(list_w)
line2.add_yaxis("æŸå¤±å€¼", list_loss)
line2.set_global_opts(
    title_opts=TitleOpts(title="æŸå¤±å€¼ä¸å‚æ•°çš„å…³ç³»", pos_left="center", pos_bottom="1%"),
    toolbox_opts=ToolboxOpts(is_show=True),
)
line2.render()
```
 
 ### è¿è¡Œç»“æœå¤§è‡´æƒ…å†µ
 <img width="761" alt="æˆªå±2025-04-10 22 29 05" src="https://github.com/user-attachments/assets/42d32c4d-94d0-4bd1-8b3f-fc242b1eb7d0" />
