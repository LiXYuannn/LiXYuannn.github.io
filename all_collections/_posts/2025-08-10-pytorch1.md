---
layout: post
title: Pytorchç¬”è®°ğŸ““ç¬¬ä¸€å¼¹
date: 2025-08-10 00:00:00
categories: ["æ·±åº¦å­¦ä¹ ","Pytorch"]
---

### Pytorchçš„æ ¸å¿ƒâ€”â€”å¼ é‡

åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæ‰€æœ‰çš„æ•°æ®å’Œæ¨¡å‹å‚æ•°éƒ½ç”¨å¼ é‡è¡¨ç¤ºã€‚

å¼ é‡ï¼ˆTensorï¼‰å¯ä»¥çœ‹æˆæ˜¯ï¼š

- **0 ç»´**ï¼šæ ‡é‡ï¼ˆscalarï¼‰ï¼Œæ¯”å¦‚ 3
- **1 ç»´**ï¼šå‘é‡ï¼ˆvectorï¼‰ï¼Œæ¯”å¦‚ [1, 2, 3]
- **2 ç»´**ï¼šçŸ©é˜µï¼ˆmatrixï¼‰
- **3 ç»´åŠä»¥ä¸Š**ï¼šé«˜ç»´æ•°ç»„ï¼Œæ¯”å¦‚ä¸€æ‰¹å›¾ç‰‡ (batch_size, height, width, channels)

ğŸ“Œ åœ¨ PyTorch é‡Œï¼š

- **torch.tensor()** åˆ›å»ºå¼ é‡
- **.shape** æŸ¥çœ‹ç»´åº¦
- **.dtype** æ•°æ®ç±»å‹
- **.to(device)** æŠŠå¼ é‡æ”¾åˆ° CPU/GPU

### GPUåŠ é€Ÿ

å¦‚æœæœ‰GPUï¼ŒPyTorch ä¼šè‡ªåŠ¨å¸®ä½ ç”¨ CUDA åŠ é€Ÿ
```python

device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
x = torch.randn(3, 4).to(device)
```

### è‡ªåŠ¨æ±‚å¯¼

PyTorch å¯ä»¥è‡ªåŠ¨è®¡ç®—æ¢¯åº¦ï¼Œè¿™å°±æ˜¯æ·±åº¦å­¦ä¹ è®­ç»ƒçš„åŸºç¡€ã€‚

- åˆ›å»ºå¼ é‡æ—¶åŠ  requires_grad=Trueï¼ŒPyTorch ä¼šè®°å½•è®¡ç®—å›¾ã€‚
- è°ƒç”¨ .backward() è‡ªåŠ¨åå‘ä¼ æ’­ï¼Œè®¡ç®—æ¢¯åº¦ã€‚
- æ¢¯åº¦å­˜æ”¾åœ¨ .grad é‡Œã€‚

#### ç¬¬ä¸€ä¸ªPytorchæ–‡ä»¶

```python
#myfirstPytorch
import torch
print(torch.__version__)
  
x=torch.tensor([[1,2],[3,4]],dtype=torch.float32)
y=torch.ones((2,2))

print("x:\n",x)
print("y:\n",y)

z=x+y
print("z:\n",z)

device=torch.device("cuda" if torch.cuda.is_available() else "cpu")
x=x.to(device)
y=y.to(device)
x=x.to(device)
print("è®¾å¤‡:",device)
  
a=torch.randn(3,4,requires_grad=True)
b=torch.randn(3,4)
c=a*b
out=c.sum()
out.backward()
print("açš„æ¢¯åº¦:\n",a.grad)

```

```bash
#è¿è¡Œç»“æœ
2.6.0
x:
 tensor([[1., 2.],
        [3., 4.]])
y:
 tensor([[1., 1.],
        [1., 1.]])
x:
 tensor([[2., 3.],
        [4., 5.]])
è®¾å¤‡: cpu
açš„æ¢¯åº¦:
 tensor([[ 0.4779,  1.5350,  0.0037,  1.2580],
        [-0.5812,  1.6379,  0.7242,  1.2655],
        [-0.6917, -0.8033, -1.8678, -1.1883]])

```

### è¿›é˜¶ä»»åŠ¡ ğŸ–Šï¸
- åˆ›å»ºä¸€ä¸ª (2, 3, 4) çš„éšæœºå¼ é‡ tï¼ˆfloat ç±»å‹ï¼‰    
- å¯¹å®ƒåšï¼š
    - åŠ æ³•ï¼ˆ+ 1ï¼‰
    - å‡æ³•ï¼ˆ- 0.5ï¼‰
    - çŸ©é˜µä¹˜æ³•ï¼ˆç”¨ .matmul() æˆ– @ï¼‰*
- æŠŠå®ƒç§»åˆ° GPUï¼ˆå¦‚æœæ²¡æœ‰ GPU å°±ä¾ç„¶ç”¨ CPUï¼‰ï¼Œå¹¶æ‰“å°ï¼š
    - .shape
    - .dtype

```python

import torch

t=torch.randn(2,3,4,dtype=torch.float32)
x=torch.ones((2,3,4))

print("t:\n",t)
a=t+x
b=t-x*0.5
  
device=torch.device("cuda" if torch.cuda.is_available() else "cpu")
# t=t.to(device)
# x=x.to(device)
# a=a.to(device)
# b=b.to(device)
t, x, a, b=[tensor.to(device) for tensor in [t, x, a, b]]
print("è®¾å¤‡:\n",device)

print("a:\n",a)
print("b:\n",b)
  
print(".shape:\n",t.shape)
print(".dtype:\n",t.dtype)

```

```bash
#è¿è¡Œç»“æœ
t:
 tensor([[[-0.5283,  1.2119,  1.6814,  0.6434],
         [-0.3742, -0.8421, -1.6161,  0.2300],
         [-1.2224,  0.4019, -1.4070,  0.4027]],

        [[ 0.0407, -0.5536, -0.7496,  1.7721],
         [ 1.4842,  0.2181, -0.0732, -1.1741],
         [ 0.4077, -0.7331, -2.2628,  0.8560]]])
è®¾å¤‡:
 cpu
a:
 tensor([[[ 0.4717,  2.2119,  2.6814,  1.6434],
         [ 0.6258,  0.1579, -0.6161,  1.2300],
         [-0.2224,  1.4019, -0.4070,  1.4027]],

        [[ 1.0407,  0.4464,  0.2504,  2.7721],
         [ 2.4842,  1.2181,  0.9268, -0.1741],
         [ 1.4077,  0.2669, -1.2628,  1.8560]]])
b:
 tensor([[[-1.0283,  0.7119,  1.1814,  0.1434],
         [-0.8742, -1.3421, -2.1161, -0.2700],
         [-1.7224, -0.0981, -1.9070, -0.0973]],

        [[-0.4593, -1.0536, -1.2496,  1.2721],
         [ 0.9842, -0.2819, -0.5732, -1.6741],
         [-0.0923, -1.2331, -2.7628,  0.3560]]])
.shape:
 torch.Size([2, 3, 4])
.dtype:
 torch.float32
 
```

>çŸ©é˜µä¹˜æ³•çš„å®ç°
>â€”â€”ç”¨ .matmul() æˆ– @

å› ä¸ºå¼ é‡tç›¸å½“äº2ä¸ª3* 4çš„çŸ©é˜µï¼Œä¸èƒ½ç›´æ¥å’Œè‡ªå·±ç›¸ä¹˜ï¼Œæ‰€ä»¥éœ€è¦å†éšæœºç”Ÿæˆä¸€ä¸ªï¼ˆ2ï¼Œ4ï¼Œkï¼‰çš„çŸ©é˜µ//ä»¤k=6

```python

import torch

t=torch.randn(2,3,4,dtype=torch.float32)
s=torch.randn(2,4,6,dtype=torch.float32)
  
device=torch.device("cuda" if torch.cuda.is_available() else "cpu")
t,s=[tensor.to(device) for tensor in [t,s]]
print("è®¾å¤‡:\n",device)
  
out=torch.matmul(t,s)
#æˆ–è€…out=t@s
print("out:\n",out)
print(".shape:\n",out.shape)
print(".dtype:\n",out.dtype)

```

```bash
#è¿è¡Œç»“æœ
è®¾å¤‡:
 cpu
out:
 tensor([[[-0.6649, -0.7129,  1.1296, -1.8482,  1.4739,  0.7178],
         [-1.5440,  4.1733, -3.7995, -1.6282, -3.5405, -0.3269],
         [ 2.4297, -4.6300,  0.9426,  2.7147,  1.8590,  4.4622]],

        [[ 1.0501,  0.4767,  1.8069, -3.8165,  2.4047, -1.2312],
         [-1.2006,  0.1548, -0.6207,  1.4950, -1.4686,  1.2318],
         [-1.5264,  0.0297, -0.2412, -1.4789,  1.6743, -1.2765]]])
.shape:
 torch.Size([2, 3, 6])
.dtype:
 torch.float32
 
```

